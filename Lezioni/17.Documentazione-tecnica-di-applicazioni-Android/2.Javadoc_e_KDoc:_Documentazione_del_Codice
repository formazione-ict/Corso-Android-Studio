# 2. Javadoc e KDoc: Documentazione del Codice

## 2.1 Convenzioni KDoc per Kotlin
KDoc è il sistema di documentazione per Kotlin, equivalente a Javadoc per Java.

**Sintassi base KDoc (Kotlin):**

```
/**
 * Rappresenta una previsione meteorologica per una specifica località.
 *
 * Questa classe contiene tutti i dati necessari per visualizzare le condizioni
 * meteo attuali e le previsioni future. I dati vengono recuperati dall'API
 * OpenWeatherMap e memorizzati nel database locale per l'accesso offline.
 *
 * @property cityName Nome della città (es. "Milano")
 * @property temperature Temperatura attuale in gradi Celsius
 * @property condition Condizione meteo corrente (SUNNY, CLOUDY, RAINY, SNOWY)
 * @property humidity Percentuale di umidità (0-100)
 * @property windSpeed Velocità del vento in km/h
 * @property timestamp Timestamp UTC dell'ultimo aggiornamento
 *
 * @constructor Crea una nuova istanza di WeatherData
 *
 * @throws IllegalArgumentException se la temperatura è fuori dal range valido
 *
 * @sample com.example.weather.samples.weatherDataSample
 *
 * @see WeatherRepository
 * @see WeatherApi
 *
 * @author Mario Rossi
 * @since 1.0.0
 */
data class WeatherData(
    val cityName: String,
    val temperature: Double,
    val condition: WeatherCondition,
    val humidity: Int,
    val windSpeed: Double,
    val timestamp: Long
) {
    init {
        require(temperature in -90.0..60.0) {
            "La temperatura deve essere compresa tra -90°C e 60°C"
        }
        require(humidity in 0..100) {
            "L'umidità deve essere compresa tra 0 e 100"
        }
    }
}
```

## 2.2 Documentazione di Funzioni (Kotlin)

```
/**
 * Recupera le previsioni meteorologiche per una località specifica.
 *
 * Questa funzione sospesa recupera i dati meteo dall'API remota. Se la chiamata
 * fallisce o il dispositivo è offline, restituisce i dati dalla cache locale.
 * La funzione implementa una strategia di retry con backoff esponenziale.
 *
 * @param cityName Nome della città da cercare (non case-sensitive)
 * @param forceRefresh Se true, ignora la cache e forza il refresh dai server
 * @param units Unità di misura desiderate (METRIC per °C, IMPERIAL per °F)
 *
 * @return [Result] contenente [WeatherData] in caso di successo,
 *         o [WeatherError] in caso di fallimento
 *
 * @throws NetworkException se non c'è connessione Internet e la cache è vuota
 * @throws ApiException se l'API restituisce un errore (es. città non trovata)
 *
 * @see WeatherRepository.getCachedWeather
 * @see WeatherApi.fetchWeather
 */
suspend fun getWeatherForCity(
    cityName: String,
    forceRefresh: Boolean = false,
    units: TemperatureUnit = TemperatureUnit.METRIC
): Result<WeatherData> {
    // Implementazione
}
```

## 2.3 Documentazione di Classi ViewModel (Kotlin)

```
/**
 * ViewModel per la schermata principale dell'applicazione.
 *
 * Gestisce lo stato UI, le interazioni utente e la logica di business per
 * la visualizzazione delle previsioni meteo. Utilizza StateFlow per esporre
 * lo stato UI in modo reattivo ai composable/fragment.
 *
 * Il ViewModel segue il pattern UDF (Unidirectional Data Flow):
 * 1. L'UI invia eventi tramite [onEvent]
 * 2. Il ViewModel processa gli eventi e aggiorna [uiState]
 * 3. L'UI osserva [uiState] e si aggiorna di conseguenza
 *
 * @property weatherRepository Repository per operazioni sui dati meteo
 * @property locationService Service per ottenere la posizione corrente
 * @property savedStateHandle Handle per salvare/ripristinare lo stato
 *
 * @constructor Iniettato da Hilt con le dipendenze necessarie
 */
@HiltViewModel
class HomeViewModel @Inject constructor(
    private val weatherRepository: WeatherRepository,
    private val locationService: LocationService,
    private val savedStateHandle: SavedStateHandle
) : ViewModel() {

    /**
     * Stato UI corrente della schermata principale.
     * 
     * Espone un flusso immutabile dello stato che l'UI può osservare.
     * Inizializzato con [HomeUiState.Loading] e aggiornato in risposta
     * agli eventi utente e ai risultati delle operazioni asincrone.
     */
    val uiState: StateFlow<HomeUiState> = _uiState.asStateFlow()
    
    // Implementazione...
}
```

## 2.4 Convenzioni Javadoc per Java
**Per codice Java legacy o interoperabilità (Java):

```
/**
 * Adapter per visualizzare una lista di previsioni meteo in RecyclerView.
 * 
 * <p>Questo adapter supporta diverse tipologie di view holder per mostrare:
 * <ul>
 *   <li>Previsioni orarie (vista compatta)</li>
 *   <li>Previsioni giornaliere (vista espansa)</li>
 *   <li>Header con informazioni città</li>
 * </ul>
 * 
 * <p><b>Utilizzo:</b>
 * <pre>{@code
 * WeatherAdapter adapter = new WeatherAdapter(weatherList, clickListener);
 * recyclerView.setAdapter(adapter);
 * adapter.updateData(newWeatherList);
 * }</pre>
 * 
 * @author Mario Rossi
 * @version 1.2.0
 * @since 1.0.0
 * @see RecyclerView.Adapter
 * @see WeatherViewHolder
 */
public class WeatherAdapter extends RecyclerView.Adapter<WeatherViewHolder> {

    /**
     * Lista delle previsioni meteo da visualizzare.
     * Non deve essere null ma può essere vuota.
     */
    private List<WeatherData> weatherList;
    
    /**
     * Listener per gestire i click sugli elementi della lista.
     */
    private OnWeatherItemClickListener clickListener;

    /**
     * Costruisce un nuovo WeatherAdapter.
     *
     * @param weatherList Lista iniziale di dati meteo (non null)
     * @param clickListener Listener per eventi di click (può essere null)
     * @throws NullPointerException se weatherList è null
     */
    public WeatherAdapter(
        @NonNull List<WeatherData> weatherList,
        @Nullable OnWeatherItemClickListener clickListener
    ) {
        this.weatherList = Objects.requireNonNull(weatherList);
        this.clickListener = clickListener;
    }

    /**
     * Aggiorna la lista di previsioni e notifica i cambiamenti.
     * 
     * <p>Utilizza {@link DiffUtil} per calcolare le differenze ed eseguire
     * animazioni fluide. Operazione eseguita su thread background.
     *
     * @param newWeatherList Nuova lista di previsioni (non null)
     * @see DiffUtil
     */
    public void updateData(@NonNull List<WeatherData> newWeatherList) {
        // Implementazione
    }
}
```
